<div class="container py-4">
  <div class="page-header-with-back">
    <div class="back-navigation">
      <a routerLink="/dashboard" class="btn-back">Volver al inicio</a>
    </div>
    <div class="header-content">
      <h1>Personas</h1>
      <a routerLink="/persons/new" class="btn-create">Crear persona</a>
    </div>
  </div>

  @if (successMessage()) {
    <div class="alert alert-success">
      âœ“ {{ successMessage() }}
    </div>
  }

  @if (errorMessage()) {
    <div class="alert alert-danger">
      âš ï¸ {{ errorMessage() }}
    </div>
  }

  @if (isLoading()) {
    <div class="loading-container">
      <span class="loading"></span> Cargando personas...
    </div>
  } @else if (persons().length === 0) {
    <div class="empty-state card">
      <span class="empty-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span>
      <h3>No hay personas registradas</h3>
      <p>Comienza creando tu primera persona</p>
      <a routerLink="/persons/new" class="btn btn-primary">Crear persona</a>
    </div>
  } @else {
    <div class="table-container card">
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre Completo</th>
            <th>Documento</th>
            <th>TelÃ©fono</th>
            <th>DirecciÃ³n</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (person of persons(); track person.id) {
            <tr>
              <td>{{ person.id }}</td>
              <td>
                <div class="person-info">
                  <span class="person-avatar">ğŸ‘¤</span>
                  <strong>{{ getFullName(person) }}</strong>
                </div>
              </td>
              <td>
                <span class="document-number">ğŸ†” {{ person.identification }}</span>
              </td>
              <td>
                <span class="phone-number">ğŸ“± {{ person.phoneNumber }}</span>
              </td>
              <td>{{ person.address }}</td>
              <td>
                <div class="action-buttons">
                  <a [routerLink]="['/persons/edit', person.id]" class="btn-action btn-action-edit" title="Editar">
                    âœï¸
                  </a>
                  <button
                    (click)="openDeleteModal(person)"
                    class="btn-action btn-action-delete"
                    title="Eliminar"
                  >
                    ğŸ—‘ï¸
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>

<!-- Delete Confirmation Modal -->
@if (showDeleteModal()) {
  <div class="modal-overlay" (click)="closeDeleteModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirmar eliminaciÃ³n</h3>
        <button class="modal-close" (click)="closeDeleteModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <p>Â¿EstÃ¡s seguro de que deseas eliminar a <strong>{{ getFullName(selectedPerson()!) }}</strong>?</p>
        <p class="warning-text">Esta acciÃ³n no se puede deshacer.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDeleteModal()">Cancelar</button>
        <button class="btn btn-danger" (click)="confirmDelete()">Eliminar</button>
      </div>
    </div>
  </div>
}
